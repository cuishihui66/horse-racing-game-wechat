# 赛马摇一摇互动游戏

这是一个包含微信小程序前端、大屏显示前端、后端服务设计以及主持人后台管理界面设计的互动游戏项目。主要实现了“赛马摇一摇”小游戏的玩法，用户可以通过微信小程序扫码加入游戏，并在手机上点击加速按钮控制大屏上自己的卡通小马进行比赛。

## 项目结构

```
.
├── README.md                           # 项目说明和使用指南
├── miniprogram/                        # 微信小程序前端代码
│   ├── app.js                          # 小程序入口文件
│   ├── app.json                        # 小程序配置
│   ├── app.wxss                        # 小程序全局样式
│   ├── images/                         # 小程序图片资源
│   │   └── horse_icon.png              # 小马图标（需自行准备）
│   ├── pages/
│   │   ├── accelerate/                 # 加速页面
│   │   │   ├── accelerate.js
│   │   │   ├── accelerate.json
│   │   │   ├── accelerate.wxml
│   │   │   └── accelerate.wxss
│   │   ├── scan/                       # 扫码页面
│   │   │   ├── scan.js
│   │   │   ├── scan.json
│   │   │   ├── scan.wxml
│   │   │   └── scan.wxss
│   │   └── success/                    # 参与成功页面
│   │       ├── success.js
│   │       ├── success.json
│   │       ├── success.wxml
│   │       └── success.wxss
│   └── sitemap.json                    # 小程序sitemap配置
└── horse-race-display/                 # 大屏显示前端代码
    ├── index.html                      # 大屏显示主页面
    ├── style.css                       # 大屏显示样式
    └── script.js                       # 大屏显示逻辑（包含模拟数据和动画）
```

## 功能描述

### 赛马摇一摇游戏核心流程

1.  **扫码加入**: 主持人在大屏幕上展示一个二维码，用户使用微信扫描后，进入小程序界面。
2.  **参与成功**: 用户微信界面显示“参与成功”信息。
3.  **形象分配**: 限时结束后，大屏幕会为每个扫描成功的用户随机分配一个卡通小马形象，小马身上印有用户的微信名。
4.  **疯狂点击**: 主持人从后台点击游戏开始后，手机上的参与用户可以在小程序界面疯狂点击加速按钮。
5.  **实时加速**: 大屏幕上的小马会根据用户点击的速度实时加速。
6.  **决出胜负**: 最先到达终点的用户获得冠军，其次是亚军和季军。
7.  **排名展示**: 游戏结束后，大屏幕上会显示所有参与用户的最终排名。
8.  **游戏重置**: 主持人可以重置游戏，开始新一轮比赛。

## 使用说明

### 1. 微信小程序前端 (miniprogram/)

**开发环境**: 微信开发者工具

#### 运行步骤

1.  下载并安装 [微信开发者工具](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)。
2.  打开微信开发者工具，选择“导入项目”。
3.  项目目录选择 `miniprogram/` 文件夹。
4.  AppID 填写您自己的小程序 AppID（测试号也可以，或者选择“无 AppID 模式”进行开发调试）。
5.  点击“导入”即可在开发者工具中预览和调试小程序。

#### 主要页面

*   `pages/scan/scan`: 扫码页面，用于引导用户扫描大屏二维码。
*   `pages/success/success`: 参与成功页面，显示用户已成功加入游戏。
*   `pages/accelerate/accelerate`: 加速页面，包含用户点击的加速按钮。
    *   **注意**: `miniprogram/images/horse_icon.png` 文件需要您自行准备一个合适的小马图标放置在该目录下，否则加速按钮上的图标会缺失。

#### 模拟后端交互

小程序前端目前是模拟与后端进行交互（通过 `console.log` 打印信息），实际使用需要对接真实的后端服务和 WebSocket 通信。

### 2. 大屏显示前端 (horse-race-display/)

**运行环境**: 任意现代浏览器 (推荐 Chrome, Firefox)

#### 运行步骤

1.  使用浏览器直接打开 `horse-race-display/index.html` 文件。
2.  页面会加载大屏显示界面，并模拟游戏过程。
3.  **注意**: 此部分目前仅为前端模拟，游戏中的用户数据、马匹加速等均是前端内部模拟的随机行为。实际使用需要通过 WebSocket 连接到后端服务，接收实时数据。

#### 主要文件

*   `index.html`: 页面结构。
*   `style.css`: 页面样式，定义了赛道、马匹、排名等视觉效果。
*   `script.js`: 页面逻辑，包含了模拟参与者、马匹渲染、动画更新、实时排名和最终排名显示等功能。

#### 模拟数据和游戏流程

*   `script.js` 中 `generateMockParticipants(count)` 函数用于生成模拟的参赛者。
*   `updateGame()` 函数模拟了马匹的移动和加速过程。
*   游戏在页面加载 5 秒后自动“开始”，并在第一匹马到达终点后“结束”，显示最终排名。
*   “重置游戏”按钮可用于重新开始模拟。

### 3. 后端服务 (仅设计，未实现)

后端服务设计方案已在任务5中完成，并计划使用 Node.js (NestJS)、PostgreSQL 和 Redis，通过 WebSocket 进行实时通信。

**核心功能**:
*   **认证**: 微信用户登录认证。
*   **游戏会话管理**: 创建、加入、开始、重置游戏会话。
*   **实时数据处理**: 接收小程序加速指令，计算马匹位置和速度。
*   **排名计算**: 根据马匹位置实时更新排名，并在游戏结束时确定最终排名。
*   **WebSocket 通信**: 作为小程序和大屏之间的桥梁，广播游戏状态。

### 4. 主持人后台管理界面 (仅设计，未实现)

主持人后台管理界面设计方案已在任务7中完成。

**核心功能**:
*   **创建游戏会话**: 生成新的游戏会话和二维码。
*   **管理扫码阶段**: 控制二维码的展示和扫码时间。
*   **开始/重置游戏**: 手动触发游戏的开始和重置。
*   **查看游戏状态**: 实时查看参与人数和游戏进展。

## 下一步工作

*   **后端服务开发**: 根据设计实现后端 API 和 WebSocket 服务。
*   **实时通信集成**: 将小程序和大屏前端与后端 WebSocket 服务进行对接，替换现有模拟数据。
*   **主持人后台开发**: 实现主持人管理界面。
*   **微信认证集成**: 完成微信小程序的真实登录和用户识别。
*   **美术资源准备**: 准备真实的小马卡通图片、背景、UI元素等。

## 注意事项

*   本项目前端代码仅为概念验证和 UI 演示，未包含完整的错误处理、安全性、性能优化及与真实后端的数据交互逻辑。
*   微信小程序需要真实的 AppID 才能进行完整的线上测试和发布。
*   大屏显示在部署时需要确保后端 WebSocket 服务的可访问性。
